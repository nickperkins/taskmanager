# Design: Task Model with String ID and Completed Boolean

## Overview

This design describes the changes required to update the Task Management API's data model and endpoints to use a string `id` (client-provided or server-generated) and a boolean `completed` field, replacing the previous UUID and status string/enum. The goal is to align the implementation with the clarified specification and user stories.

---

## Data Model

### Task Struct

```go
// Task represents a task in the Task Management API.
type Task struct {
    ID        string    `json:"id"`
    Title     string    `json:"title"`
    Description string  `json:"description,omitempty"`
    Completed bool      `json:"completed"`
    CreatedAt time.Time `json:"created_at"`
    UpdatedAt time.Time `json:"updated_at"`
}
```

- `ID`: string, required, unique. May be provided by the client or generated by the server (e.g., UUID as string).
- `Title`: string, required, 1-200 characters.
- `Description`: string, optional, max 1000 characters.
- `Completed`: bool, required.
- `CreatedAt`/`UpdatedAt`: timestamps, set by the server.

### Validation

- `ID` must be non-empty and unique (if provided by client).
- `Title` is required, 1-200 chars.
- `Description` is optional, max 1000 chars.
- `Completed` is required (default: false if omitted).

---

## API Endpoints

### POST /tasks

- Accepts: `{ id?, title, description?, completed }`
- If `id` is omitted, server generates a unique string (UUID or similar).
- Returns: 201 Created with the created task object.

### GET /tasks

- Returns: 200 OK with an array of all tasks, each with `id`, `title`, `description`, `completed`, `created_at`, `updated_at`.

### GET /tasks/{id}

- Returns: 200 OK with the task object, or 404 if not found.

### PUT /tasks/{id}

- Accepts: `{ title?, description?, completed? }` (partial update allowed)
- Updates only provided fields; others remain unchanged.
- Returns: 200 OK with the updated task, or 404 if not found.

### DELETE /tasks/{id}

- Deletes the task with the given id.
- Returns: 204 No Content, or 404 if not found.

---

## Service and Repository Layer

- Service and repository interfaces must use `string` for task IDs.
- All business logic, validation, and error handling must be updated to use the new model.
- Repository must enforce unique string IDs.

---

## Migration Plan

1. Update the `Task` struct and all references to use `id` (string) and `completed` (bool).
2. Update validation logic and error messages.
3. Update all handler, service, and repository methods to use string IDs and completed boolean.
4. Update tests to use the new model and field names.
5. Update API documentation and OpenAPI/Swagger (if present).
6. Document the breaking change for clients.

---

## Example JSON

### Create Task (client provides ID)

```json
{
  "id": "my-task-123",
  "title": "My Task",
  "completed": false
}
```

### Create Task (server generates ID)

```json
{
  "title": "Auto-ID Task",
  "completed": false
}
```

### Task Response

```json
{
  "id": "my-task-123",
  "title": "My Task",
  "description": "Optional description",
  "completed": false,
  "created_at": "2025-07-29T12:00:00Z",
  "updated_at": "2025-07-29T12:00:00Z"
}
```

---

## Backward Compatibility

- This is a breaking change. All clients must update to use string IDs and the `completed` boolean field.
- The `status` field and UUID type are no longer supported.

---

## Open Questions & Answers

- Should the server validate that client-provided IDs are unique and non-empty? **Yes, this is needed.**
- Should the server restrict the format of IDs (e.g., only alphanumeric, max length)? **Yes, IDs must be alphanumeric and dashes only, with a max length of 24.**
- Should partial updates via PUT be allowed for all fields, or only some? **ID, createdAt, and updatedAt must be immutable; all other fields may be updated.**

---

## Summary

This design ensures the Task Management API is compliant with the clarified requirements, simplifies integration for clients, and maintains all concurrency, validation, and error handling guarantees.
